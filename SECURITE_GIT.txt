â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘   ğŸ”’ GUIDE DE SÃ‰CURITÃ‰ : Nettoyage de l'Historique Git                     â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  IMPORTANT : SI VOUS AVEZ DÃ‰JÃ€ COMMITÃ‰ DES SECRETS PAR LE PASSÃ‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Les fichiers dans .gitignore ne sont PAS supprimÃ©s de l'historique Git.
Si vous avez commitÃ© .env ou d'autres secrets par le passÃ©, ils sont toujours
accessibles dans l'historique, mÃªme si vous les supprimez maintenant.


ğŸ” VÃ‰RIFIER SI VOUS AVEZ COMMITÃ‰ DES SECRETS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. VÃ©rifier si .env a Ã©tÃ© commitÃ© dans le passÃ© :

    git log --all --full-history -- .env

    Si vous voyez des commits â†’ NETTOYAGE NÃ‰CESSAIRE âš ï¸
    Si vide â†’ Tout va bien âœ…


2. Rechercher les clÃ©s API dans tout l'historique :

    git log --all -S "sk-proj-" --source --all
    git log --all -S "gsk_" --source --all
    git log --all -S "OPENAI_API_KEY" --source --all

    Si vous trouvez des rÃ©sultats â†’ NETTOYAGE NÃ‰CESSAIRE âš ï¸


ğŸ§¹ MÃ‰THODE 1 : RÃ©initialisation ComplÃ¨te (RecommandÃ© si aucun historique important)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  ATTENTION : Ceci supprime TOUT l'historique Git

cd /home/tahar/project/AMP

# 1. Sauvegarder le code actuel
cp -r . ../AMP_backup

# 2. Supprimer l'historique Git
rm -rf .git

# 3. RÃ©initialiser Git proprement
git init
git add .
git commit -m "ğŸ“ Initial commit: Chatbot RAG (historique nettoyÃ©)"

# 4. Pousser sur GitHub
git remote add origin https://github.com/VOTRE_USERNAME/chatbot-rag-reglements.git
git branch -M main
git push -u origin main --force

âœ… Historique propre, pas de secrets


ğŸ”§ MÃ‰THODE 2 : Nettoyage avec BFG Repo-Cleaner (Si vous voulez garder l'historique)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BFG est un outil qui supprime les fichiers sensibles de TOUT l'historique Git.

1. Installer BFG :

    sudo apt install default-jre
    wget https://repo1.maven.org/maven2/com/madgag/bfg/1.14.0/bfg-1.14.0.jar
    alias bfg='java -jar bfg-1.14.0.jar'


2. CrÃ©er un fichier avec les patterns Ã  supprimer :

    cat > secrets.txt << EOF
    sk-proj-*
    gsk_*
    Forzaitalia02800280
    EOF


3. Nettoyer l'historique :

    cd /home/tahar/project/AMP
    
    # Supprimer le fichier .env de tout l'historique
    bfg --delete-files .env
    
    # Supprimer les secrets par pattern
    bfg --replace-text secrets.txt
    
    # Nettoyer dÃ©finitivement
    git reflog expire --expire=now --all
    git gc --prune=now --aggressive


4. VÃ©rifier que c'est propre :

    git log --all -S "sk-proj-" --source --all
    # Devrait Ãªtre vide


5. Pousser sur GitHub :

    git push origin --force --all


âœ… Historique nettoyÃ©, secrets supprimÃ©s


ğŸ›¡ï¸  MÃ‰THODE 3 : Utiliser git-filter-repo (Moderne, RecommandÃ©)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

git-filter-repo est l'outil officiel recommandÃ© par Git.

1. Installer git-filter-repo :

    pip install git-filter-repo --break-system-packages


2. Supprimer .env de tout l'historique :

    cd /home/tahar/project/AMP
    git filter-repo --path .env --invert-paths


3. Supprimer les secrets par pattern :

    cat > replacements.txt << EOF
    sk-proj-==>REDACTED_OPENAI_KEY
    gsk_==>REDACTED_GROQ_KEY
    Forzaitalia02800280==>REDACTED_PASSWORD
    EOF
    
    git filter-repo --replace-text replacements.txt


4. Pousser sur GitHub :

    git remote add origin https://github.com/VOTRE_USERNAME/chatbot-rag-reglements.git
    git push -u origin main --force


âœ… Historique nettoyÃ© avec l'outil officiel


ğŸ” APRÃˆS LE NETTOYAGE : Actions de SÃ©curitÃ©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âš ï¸  RÃ‰VOQUER IMMÃ‰DIATEMENT LES ANCIENNES CLÃ‰S :

   OpenAI : https://platform.openai.com/api-keys
   â†’ Supprimez la clÃ© sk-proj-XXXXXXXXXXXXXXXX

   Groq : https://console.groq.com/keys
   â†’ Supprimez la clÃ© gsk_XXXXXXXXXXXXXXXX

   Gmail : https://myaccount.google.com/apppasswords
   â†’ Supprimez le mot de passe d'application XXXXXXXXXXXXXXXX


2. ğŸ”‘ GÃ‰NÃ‰RER DE NOUVELLES CLÃ‰S :

   - CrÃ©ez de nouvelles clÃ©s sur les plateformes
   - Mettez-les dans .env (qui est maintenant dans .gitignore)
   - NE LES COMMITTEZ JAMAIS


3. âœ… VÃ‰RIFIER LE .gitignore :

    cat .gitignore | grep ".env"
    
    Doit contenir :
    .env
    *.env
    .env.*
    !.env.example


4. ğŸ“§ CHANGER LE MOT DE PASSE EMAIL :

   Si Forzaitalia02800280 Ã©tait votre vrai mot de passe :
   â†’ Changez-le immÃ©diatement sur Gmail
   â†’ GÃ©nÃ©rez un nouveau mot de passe d'application


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ“‹ CHECKLIST FINALE AVANT PUBLICATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Avant de publier sur GitHub, vÃ©rifiez :

â–¡ .env est dans .gitignore
â–¡ Aucun secret dans l'historique Git (vÃ©rifiÃ© avec git log)
â–¡ README.md est prÃªt (informations personnelles mises Ã  jour)
â–¡ LICENSE crÃ©Ã©
â–¡ .env.example crÃ©Ã© (template sans vraies clÃ©s)
â–¡ RÃ©pertoire faiss_index/ est dans .gitignore (trop lourd)
â–¡ Anciennes clÃ©s rÃ©voquÃ©es si elles Ã©taient dans Git


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ’¡ CONSEIL : Utilisation de .env.example
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Au lieu de commit .env, crÃ©ez un .env.example :

    # Copier .env vers .env.example
    cp .env .env.example

    # Remplacer les vraies valeurs par des exemples
    nano .env.example

Contenu de .env.example :

    # ClÃ© API Groq (gratuit sur https://console.groq.com/keys)
    GROQ_API_KEY=gsk_YOUR_KEY_HERE

    # ClÃ© API DeepSeek (backup - https://platform.deepseek.com/api_keys)
    OPENAI_API_KEY=sk-YOUR_KEY_HERE

    # Configuration Email (optionnel)
    SENDER_EMAIL=your.email@example.com
    GMAIL_APP_PASSWORD=YOUR_APP_PASSWORD
    RECEIVER_EMAIL=destination@example.com

Ensuite, commit .env.example :

    git add .env.example
    git commit -m "Add .env.example template"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸš¨ EN CAS D'URGENCE : Secrets dÃ©jÃ  publiÃ©s sur GitHub
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si vous avez DÃ‰JÃ€ poussÃ© des secrets sur GitHub :

1. RÃ©voquez IMMÃ‰DIATEMENT toutes les clÃ©s
2. Supprimez le dÃ©pÃ´t GitHub
3. Nettoyez l'historique local (mÃ©thodes ci-dessus)
4. Re-crÃ©ez un nouveau dÃ©pÃ´t GitHub propre
5. Changez tous vos mots de passe


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pour plus d'aide : https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository
